<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="uk.sky.cqlmigrate.ClusterHealthTest" tests="1" skipped="0" failures="0" errors="0" timestamp="2017-09-01T07:02:36" hostname="mirek-HP-Pavilion-g6-Notebook-PC" time="2.319">
  <properties/>
  <testcase name="shouldThrowExceptionIfHostIsDown" classname="uk.sky.cqlmigrate.ClusterHealthTest" time="2.319"/>
  <system-out><![CDATA[08:02:36.384 [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-3] INFO  o.s.server.priming.PrimingServer - Opening port 33053 for priming
[INFO] [09/01/2017 08:02:36.387] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-4] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener] Port 38833 ready for Cassandra binary connections. Actor[akka://CassandraServerStub-38833-33053/system/IO-TCP/selectors/$a/0#368105644]
08:02:36.388 [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-2] INFO  o.s.server.ServerReadyListener - ServerReady - Forwarding ServerReady to listener.
08:02:36.389 [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] INFO  o.s.server.priming.PrimingServer - Priming server bound to admin port 33053
08:02:36.390 [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] INFO  o.s.server.ServerReadyListener - ServerReady - Forwarding ServerReady to listener.
[INFO] [09/01/2017 08:02:36.389] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-7] [akka://CassandraServerStub-38833-33053/user/IO-HTTP/listener-0] Bound to localhost/127.0.0.1:33053
08:02:36.390 [Test worker] INFO  c.datastax.driver.core.ClockFactory - Using native clock to generate timestamps.
[WARN] [09/01/2017 08:02:36.397] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-7] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36762] Received protocol version 4, currently only one and two supported so sending an unsupported protocol error to get the driver to use an older version of the protocol.
[INFO] [09/01/2017 08:02:36.399] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36762] Client disconnected: PeerClosed
[INFO] [09/01/2017 08:02:36.401] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-2] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a] Sending ready message to Actor[akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764#1611480823]
[INFO] [09/01/2017 08:02:36.403] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] No prime found for SELECT * FROM system.local WHERE key='local'
[INFO] [09/01/2017 08:02:36.403] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] Incoming query: SELECT * FROM system.local WHERE key='local' at consistency: org.scassandra.server.cqlmessages.ONE$@1006a4ce
[INFO] [09/01/2017 08:02:36.403] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] No prime found for SELECT * FROM system.peers
[INFO] [09/01/2017 08:02:36.403] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] Incoming query: SELECT * FROM system.peers at consistency: org.scassandra.server.cqlmessages.ONE$@1006a4ce
08:02:36.404 [Test worker] WARN  c.d.driver.core.ControlConnection - Cannot find Cassandra version for host localhost/127.0.0.1:38833 to parse the schema, using 2.0.0 based on protocol version in use. If parsing the schema fails, this could be the cause
[INFO] [09/01/2017 08:02:36.405] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-9] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] No prime found for SELECT * FROM system.schema_keyspaces
[INFO] [09/01/2017 08:02:36.405] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-9] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] Incoming query: SELECT * FROM system.schema_keyspaces at consistency: org.scassandra.server.cqlmessages.ONE$@1006a4ce
[INFO] [09/01/2017 08:02:36.405] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-9] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] No prime found for SELECT * FROM system.schema_columnfamilies
[INFO] [09/01/2017 08:02:36.405] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-9] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] Incoming query: SELECT * FROM system.schema_columnfamilies at consistency: org.scassandra.server.cqlmessages.ONE$@1006a4ce
[INFO] [09/01/2017 08:02:36.405] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-9] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] No prime found for SELECT * FROM system.schema_columns
[INFO] [09/01/2017 08:02:36.405] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-9] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36764/$a/$a] Incoming query: SELECT * FROM system.schema_columns at consistency: org.scassandra.server.cqlmessages.ONE$@1006a4ce
08:02:36.406 [Test worker] INFO  com.datastax.driver.core.Cluster - New Cassandra host localhost/127.0.0.1:38833 added
[INFO] [09/01/2017 08:02:36.411] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-10] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36766/$a] Sending ready message to Actor[akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36766#-756935652]
[INFO] [09/01/2017 08:02:36.412] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-3] [akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36768/$a] Sending ready message to Actor[akka://CassandraServerStub-38833-33053/user/BinaryTcpListener/127.0.0.1:36768#-1941034832]
08:02:36.435 [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-6] INFO  o.s.server.priming.ActivityLog - Clearing prepared statement preparations
[INFO] [09/01/2017 08:02:36.437] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-4] [akka://CassandraServerStub-38833-33053/user/IO-HTTP/listener-0/0] Message [akka.actor.Terminated] from Actor[akka://CassandraServerStub-38833-33053/user/PrimingServer/$a#1912657490] to Actor[akka://CassandraServerStub-38833-33053/user/IO-HTTP/listener-0/0#-125509234] was not delivered. [1] dead letters encountered. This logging can be turned off or adjusted with configuration settings 'akka.log-dead-letters' and 'akka.log-dead-letters-during-shutdown'.
[INFO] [09/01/2017 08:02:36.437] [CassandraServerStub-38833-33053-akka.actor.default-dispatcher-4] [akka://CassandraServerStub-38833-33053/user/IO-HTTP/listener-0/1] Message [akka.dispatch.sysmsg.DeathWatchNotification] from Actor[akka://CassandraServerStub-38833-33053/user/IO-HTTP/listener-0/1#-878002063] to Actor[akka://CassandraServerStub-38833-33053/user/IO-HTTP/listener-0/1#-878002063] was not delivered. [2] dead letters encountered. This logging can be turned off or adjusted with configuration settings 'akka.log-dead-letters' and 'akka.log-dead-letters-during-shutdown'.
08:02:36.445 [cluster5-reconnection-0] ERROR c.d.driver.core.ControlConnection - [Control connection] Cannot connect to any host, scheduling retry in 1000 milliseconds
08:02:36.449 [Test worker] INFO  o.scassandra.server.ServerStubRunner - Server is shut down
08:02:36.485 [Test worker] INFO  o.scassandra.server.ServerStubRunner - Server is shut down
]]></system-out>
  <system-err><![CDATA[uk.sky.cqlmigrate.exception.ClusterUnhealthyException: Cluster not healthy, the following hosts are down: [localhost/127.0.0.1]
	at uk.sky.cqlmigrate.ClusterHealth.check(ClusterHealth.java:28)
	at org.assertj.core.api.ThrowableAssert.catchThrowable(ThrowableAssert.java:61)
	at org.assertj.core.api.Assertions.catchThrowable(Assertions.java:643)
	at uk.sky.cqlmigrate.ClusterHealthTest.shouldThrowExceptionIfHostIsDown(ClusterHealthTest.java:67)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy3.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:147)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:129)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
]]></system-err>
</testsuite>
